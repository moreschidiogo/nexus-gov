<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Gov | Gestão de Projetos</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --primary: #2563eb;
            --primary-hover: #1d4ed8;
            --bg-body: #f8fafc;
            --bg-card: #ffffff;
            --text-main: #0f172a;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --sidebar-width: 260px;
            --radius: 12px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* Reset & Base */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; outline: none; }
        body { background: var(--bg-body); color: var(--text-main); height: 100vh; display: flex; overflow: hidden; }
        a { text-decoration: none; color: inherit; }
        button { cursor: pointer; border: none; background: none; font-family: inherit; }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: #0f172a;
            color: white;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .brand {
            font-size: 1.25rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 2.5rem;
            color: white;
        }

        .nav-link {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            color: #94a3b8;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.25rem;
            transition: all 0.2s;
            font-size: 0.95rem;
        }
        
        .nav-link:hover, .nav-link.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .nav-link.active { font-weight: 600; border-left: 3px solid var(--primary); }

        .user-profile {
            margin-top: auto;
            padding-top: 1.25rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .avatar { width: 32px; height: 32px; border-radius: 50%; object-fit: cover; }
        .user-info div:first-child { font-size: 0.9rem; font-weight: 600; }
        .user-info div:last-child { font-size: 0.75rem; color: #94a3b8; }

        /* Main Content */
        .main-content { flex: 1; overflow-y: auto; padding: 2rem; position: relative; }

        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
        .page-title h1 { font-size: 1.5rem; font-weight: 700; color: var(--text-main); }
        .page-title p { color: var(--text-secondary); font-size: 0.875rem; margin-top: 4px; }

        .btn-primary {
            background: var(--primary);
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }
        .btn-primary:hover { background: var(--primary-hover); }

        /* Metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card {
            background: var(--bg-card);
            border-radius: var(--radius);
            border: 1px solid var(--border-color);
            padding: 1.5rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }

        .metric-card { display: flex; flex-direction: column; justify-content: space-between; height: 100%; }
        .metric-label { font-size: 0.85rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 0.5rem; }
        .metric-value { font-size: 1.75rem; font-weight: 700; color: var(--text-main); }
        .trend { font-size: 0.8rem; margin-top: 0.75rem; display: flex; align-items: center; gap: 4px; }
        .trend.up { color: #10b981; }
        .trend.down { color: #ef4444; }

        /* Filters & Grid */
        .controls-bar {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            background: var(--bg-card);
            padding: 1rem;
            border-radius: var(--radius);
            border: 1px solid var(--border-color);
            flex-wrap: wrap;
        }

        .search-wrapper { flex: 1; position: relative; min-width: 250px; }
        .search-wrapper i { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-secondary); }
        .search-input {
            width: 100%;
            padding: 0.6rem 0.6rem 0.6rem 2.5rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.9rem;
        }
        .filter-select { padding: 0.6rem; border: 1px solid var(--border-color); border-radius: 6px; background: white; color: var(--text-main); }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        .project-card {
            background: var(--bg-card);
            border-radius: var(--radius);
            border: 1px solid var(--border-color);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .project-card:hover { transform: translateY(-4px); box-shadow: var(--shadow); border-color: #cbd5e1; }

        .card-header { padding: 1.25rem; border-bottom: 1px solid #f1f5f9; display: flex; justify-content: space-between; align-items: start; }
        .card-body { padding: 1.25rem; flex: 1; }
        .card-footer { padding: 1rem 1.25rem; background: #f8fafc; border-top: 1px solid var(--border-color); display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-secondary); }

        .project-title { font-weight: 700; font-size: 1.1rem; margin-bottom: 0.5rem; color: var(--text-main); }
        .project-desc { font-size: 0.9rem; color: var(--text-secondary); line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

        /* Badges */
        .badge { padding: 4px 10px; border-radius: 20px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
        .badge.backlog { background: #f1f5f9; color: #475569; }
        .badge.dev { background: #eff6ff; color: #1d4ed8; }
        .badge.homolog { background: #f3e8ff; color: #7e22ce; }
        .badge.done { background: #dcfce7; color: #15803d; }

        /* Modal */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(2px); z-index: 100;
            display: none; align-items: center; justify-content: center;
        }
        
        .modal-overlay.open { display: flex; animation: fadeIn 0.2s ease-out; }

        .modal-content {
            background: var(--bg-card); width: 95%; max-width: 1100px; height: 90vh;
            border-radius: 16px; display: flex; overflow: hidden;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .modal-body { flex: 2; padding: 2.5rem; overflow-y: auto; }
        .modal-aside { flex: 1; background: #f8fafc; border-left: 1px solid var(--border-color); padding: 2rem; display: flex; flex-direction: column; gap: 1.5rem; }

        .modal-header { display: flex; justify-content: space-between; margin-bottom: 2rem; }
        .close-btn { font-size: 1.25rem; color: var(--text-secondary); padding: 0.5rem; transition: color 0.2s; }
        .close-btn:hover { color: #ef4444; }

        .detail-group { margin-bottom: 1.5rem; }
        .detail-label { display: block; font-size: 0.75rem; font-weight: 700; color: #94a3b8; text-transform: uppercase; margin-bottom: 0.5rem; }
        .detail-text { font-size: 1rem; color: var(--text-main); line-height: 1.6; }
        
        .code-block { background: #1e293b; color: #e2e8f0; padding: 1rem; border-radius: 8px; font-family: monospace; font-size: 0.85rem; }

        /* Timeline */
        .timeline { margin-top: 2rem; border-top: 1px solid var(--border-color); padding-top: 1.5rem; }
        .timeline-item { display: flex; gap: 1rem; margin-bottom: 1.25rem; }
        .timeline-marker { width: 10px; height: 10px; border-radius: 50%; background: var(--primary); margin-top: 6px; flex-shrink: 0; }
        .timeline-date { font-size: 0.75rem; color: #94a3b8; display: block; margin-top: 4px; }

        /* Utility */
        .file-preview { text-align: center; padding: 1rem; border: 1px dashed var(--border-color); border-radius: 8px; }
        .w-full { width: 100%; }
        .hidden { display: none !important; }

        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .modal-content { flex-direction: column; height: 100%; width: 100%; border-radius: 0; }
            .modal-aside { display: none; }
        }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="brand">
            <i class="fa-solid fa-cube fa-lg"></i>
            <span>Nexus Gov</span>
        </div>
        <nav>
            <a href="#" class="nav-link active"><i class="fa-solid fa-chart-pie"></i> <span>Dashboard</span></a>
            <a href="#" class="nav-link"><i class="fa-solid fa-list-check"></i> <span>Projetos (DRNs)</span></a>
            <a href="#" class="nav-link"><i class="fa-solid fa-database"></i> <span>Data Lake</span></a>
            <a href="#" class="nav-link"><i class="fa-solid fa-gear"></i> <span>Configurações</span></a>
        </nav>
        <div class="user-profile">
            <img src="https://ui-avatars.com/api/?name=Diogo+Lima&background=random" alt="User Profile" class="avatar">
            <div class="user-info">
                <div>Diogo Lima</div>
                <div>Admin</div>
            </div>
        </div>
    </aside>

    <main class="main-content">
        <header class="header">
            <div class="page-title">
                <h1>Visão Geral</h1>
                <p>Monitoramento de demandas e KPIs de Business Intelligence</p>
            </div>
            <button class="btn-primary" id="btnNewRequest">
                <i class="fa-solid fa-plus"></i> Nova Solicitação
            </button>
        </header>

        <section class="metrics-grid">
            <div class="card metric-card">
                <div>
                    <div class="metric-label">Projetos Ativos</div>
                    <div class="metric-value">12</div>
                </div>
                <div class="trend up"><i class="fa-solid fa-arrow-trend-up"></i> +2 essa semana</div>
            </div>
            <div class="card metric-card">
                <div>
                    <div class="metric-label">SLA de Entrega</div>
                    <div class="metric-value">94%</div>
                </div>
                <div class="trend up"><i class="fa-solid fa-check"></i> Meta batida</div>
            </div>
            <div class="card metric-card">
                <div>
                    <div class="metric-label">Backlog</div>
                    <div class="metric-value">8</div>
                </div>
                <div class="trend down"><i class="fa-solid fa-arrow-trend-down"></i> -3 vs mês anterior</div>
            </div>
            <div class="card" style="padding: 1rem;">
                <canvas id="kpiChart"></canvas>
            </div>
        </section>

        <div class="controls-bar">
            <div class="search-wrapper">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="text" id="searchInput" class="search-input" placeholder="Buscar projeto, tag ou ID...">
            </div>
            <select id="statusFilter" class="filter-select">
                <option value="all">Todos os Status</option>
                <option value="Dev">Em Desenvolvimento</option>
                <option value="Entregue">Entregues</option>
                <option value="Backlog">Backlog</option>
            </select>
        </div>

        <div class="projects-grid" id="projectsContainer">
            </div>
    </main>

    <div class="modal-overlay" id="projectModal">
        <div class="modal-content">
            <div class="modal-body">
                <header class="modal-header">
                    <div>
                        <span id="modalBadge" class="badge"></span>
                        <h2 id="modalTitle" style="font-size: 1.75rem; margin-top: 0.5rem;"></h2>
                        <small id="modalId" style="color: var(--text-secondary);"></small>
                    </div>
                    <button class="close-btn" id="modalClose"><i class="fa-solid fa-xmark"></i></button>
                </header>

                <div class="detail-group">
                    <span class="detail-label">Contexto de Negócio</span>
                    <p id="modalDesc" class="detail-text"></p>
                </div>

                <div class="detail-group">
                    <span class="detail-label">Especificação Técnica</span>
                    <div id="modalTech" class="code-block"></div>
                </div>

                <div class="timeline">
                    <span class="detail-label">Histórico</span>
                    <div id="modalTimeline"></div>
                </div>
            </div>

            <aside class="modal-aside">
                <div class="file-preview">
                    <i class="fa-solid fa-file-pdf fa-3x" style="color: #ef4444; margin-bottom: 0.5rem;"></i>
                    <p id="modalFilename" style="font-weight: 500; font-size: 0.9rem; margin-bottom: 1rem;"></p>
                    <button class="btn-primary w-full" style="justify-content: center;">
                        <i class="fa-solid fa-download"></i> Download
                    </button>
                </div>

                <div>
                    <span class="detail-label">Solicitante</span>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="width: 32px; height: 32px; background: #e2e8f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.8rem;">MJ</div>
                        <span style="font-size: 0.9rem;">Maria Juarez (Ops)</span>
                    </div>
                </div>
                
                <div>
                    <span class="detail-label">Prazo Estimado</span>
                    <span style="font-weight: 600;">15/02/2026</span>
                </div>
            </aside>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- Data Source ---
            const projectsData = [
                {
                    id: "DRN-2026-001",
                    title: "Automação de Validação de Endereços (RPA)",
                    desc: "Implementação de robô para sanitização automática da base de endereços com índice de erro > 15%. O processo atual é manual e consome 40h/mês.",
                    tech: "Python (Selenium) + Pandas. API Google Maps. Saída: Databricks 'tb_end_validado'.",
                    status: "Em Homologação",
                    badgeType: "homolog",
                    client: "Logística Reversa",
                    file: "Espec_RPA_Enderecos_v2.pdf",
                    timeline: [
                        { title: "Homologação Iniciada", date: "08/01/2026" },
                        { title: "Code Freeze", date: "05/01/2026" }
                    ]
                },
                {
                    id: "DRN-2026-002",
                    title: "Painel de Controle de Entregas (Real-time)",
                    desc: "Dashboard executivo para monitoramento de SLA das transportadoras parceiras em tempo real.",
                    tech: "Power BI + Direct Query. View 'vw_tracking_live' (Refresh 15min).",
                    status: "Entregue",
                    badgeType: "done",
                    client: "Diretoria Ops",
                    file: "Dashboard_Spec.pptx",
                    timeline: [
                        { title: "Entregue e Validado", date: "20/12/2025" }
                    ]
                },
                {
                    id: "DRN-2026-003",
                    title: "Extrator Financeiro - Conciliação",
                    desc: "Automação da extração de faturas para conciliação financeira. Cruzamento previsto vs. realizado.",
                    tech: "SQL (Databricks) + Python Script para envio SMTP.",
                    status: "Em Desenvolvimento",
                    badgeType: "dev",
                    client: "Financeiro",
                    file: "Req_Financeiro_v1.docx",
                    timeline: [
                        { title: "Ajuste Regra ICMS", date: "07/01/2026" }
                    ]
                },
                {
                    id: "DRN-2026-004",
                    title: "API Integração TMS x ERP",
                    desc: "Endpoint para atualização de status de pedidos no ERP legado via webhook.",
                    tech: "Node.js (Azure Functions) + JSON Payload.",
                    status: "Backlog",
                    badgeType: "backlog",
                    client: "TI Sistemas",
                    file: "Arquitetura_API.pdf",
                    timeline: [
                        { title: "Kickoff", date: "02/01/2026" }
                    ]
                },
                {
                    id: "DRN-2026-005",
                    title: "Modelo Preditivo (Black Friday)",
                    desc: "Algoritmo para previsão de gargalos na malha logística baseado em histórico.",
                    tech: "Python (Scikit-Learn). Regressão Linear.",
                    status: "Em Homologação",
                    badgeType: "homolog",
                    client: "Planejamento",
                    file: "Estudo_DataScience.pdf",
                    timeline: [
                        { title: "Validação do Modelo", date: "09/01/2026" }
                    ]
                }
            ];

            // --- DOM Elements ---
            const gridContainer = document.getElementById('projectsContainer');
            const searchInput = document.getElementById('searchInput');
            const modal = document.getElementById('projectModal');
            const modalCloseBtn = document.getElementById('modalClose');

            // --- Core Functions ---
            
            const createCardHTML = (project) => `
                <article class="project-card" data-id="${project.id}">
                    <div class="card-header">
                        <span class="badge ${project.badgeType}">${project.status}</span>
                        <i class="fa-solid fa-ellipsis" style="color: #cbd5e1;"></i>
                    </div>
                    <div class="card-body">
                        <h3 class="project-title">${project.title}</h3>
                        <p class="project-desc">${project.desc}</p>
                    </div>
                    <div class="card-footer">
                        <span><i class="fa-regular fa-user"></i> ${project.client}</span>
                        <span><i class="fa-solid fa-code"></i> Tech</span>
                    </div>
                </article>
            `;

            const renderProjects = (filterText = '') => {
                const term = filterText.toLowerCase();
                const filtered = projectsData.filter(p => 
                    p.title.toLowerCase().includes(term) || 
                    p.status.toLowerCase().includes(term) ||
                    p.id.toLowerCase().includes(term)
                );
                
                gridContainer.innerHTML = filtered.map(createCardHTML).join('');
                
                // Re-attach event listeners to new cards
                document.querySelectorAll('.project-card').forEach(card => {
                    card.addEventListener('click', () => openProjectModal(card.dataset.id));
                });
            };

            const openProjectModal = (id) => {
                const data = projectsData.find(p => p.id === id);
                if (!data) return;

                // Populate Data
                document.getElementById('modalTitle').textContent = data.title;
                document.getElementById('modalId').textContent = data.id;
                document.getElementById('modalBadge').className = `badge ${data.badgeType}`;
                document.getElementById('modalBadge').textContent = data.status;
                document.getElementById('modalDesc').textContent = data.desc;
                document.getElementById('modalTech').textContent = data.tech;
                document.getElementById('modalFilename').textContent = data.file;

                // Build Timeline
                const timelineContainer = document.getElementById('modalTimeline');
                timelineContainer.innerHTML = data.timeline.map(t => `
                    <div class="timeline-item">
                        <div class="timeline-marker"></div>
                        <div>
                            <div style="font-weight: 600; font-size: 0.9rem;">${t.title}</div>
                            <span class="timeline-date">${t.date}</span>
                        </div>
                    </div>
                `).join('');

                modal.classList.add('open');
            };

            const closeModal = () => {
                modal.classList.remove('open');
            };

            // --- Event Listeners ---
            
            searchInput.addEventListener('keyup', (e) => renderProjects(e.target.value));
            
            modalCloseBtn.addEventListener('click', closeModal);
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });

            document.getElementById('btnNewRequest').addEventListener('click', () => {
                console.log('Action: New Request Triggered');
            });

            // --- Initialization ---
            
            renderProjects();

            // Chart Configuration
            const ctx = document.getElementById('kpiChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['S1', 'S2', 'S3', 'S4'],
                    datasets: [{
                        data: [12, 19, 8, 15],
                        backgroundColor: '#2563eb',
                        borderRadius: 4,
                        barThickness: 12
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { 
                        x: { display: false }, 
                        y: { display: false } 
                    }
                }
            });
        });
    </script>
</body>
</html>
