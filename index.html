<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Gov | Gestão de Melhoria Contínua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --bg-body: #f1f5f9;
            --surface: #ffffff;
            --text-main: #0f172a;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: var(--bg-body); color: var(--text-main); height: 100vh; display: flex; overflow: hidden; }

        /* --- SIDEBAR --- */
        aside {
            width: 260px; background: #0f172a; color: white; display: flex; flex-direction: column;
            padding: 1.5rem; flex-shrink: 0; transition: 0.3s;
        }
        .brand { font-size: 1.25rem; font-weight: 700; display: flex; align-items: center; gap: 10px; margin-bottom: 3rem; color: white; text-decoration: none; }
        .nav-item {
            padding: 12px 16px; border-radius: 8px; color: #94a3b8; text-decoration: none;
            display: flex; align-items: center; gap: 12px; margin-bottom: 5px; transition: 0.2s; font-size: 0.95rem; cursor: pointer;
        }
        .nav-item:hover, .nav-item.active { background: rgba(255,255,255,0.1); color: white; }
        .nav-item.active { font-weight: 600; border-left: 3px solid var(--primary); }

        /* --- MAIN CONTENT --- */
        main { flex: 1; overflow-y: auto; padding: 2rem; }
        
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
        .page-title h1 { font-size: 1.75rem; font-weight: 700; color: var(--text-main); }
        .page-title p { color: var(--text-muted); font-size: 0.9rem; }

        .btn {
            padding: 10px 20px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer;
            display: inline-flex; align-items: center; gap: 8px; transition: 0.2s; font-size: 0.9rem;
        }
        .btn-primary { background: var(--primary); color: white; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3); }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-1px); }

        /* --- METRICS ROW --- */
        .metrics-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.5rem; margin-bottom: 2rem; }
        .metric-card { background: var(--surface); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border); box-shadow: var(--shadow-sm); display: flex; flex-direction: column; justify-content: space-between; }
        .metric-label { font-size: 0.85rem; color: var(--text-muted); font-weight: 600; margin-bottom: 5px; }
        .metric-value { font-size: 1.8rem; font-weight: 700; color: var(--text-main); }
        .metric-trend { font-size: 0.8rem; margin-top: 10px; }
        .trend-up { color: #10b981; } .trend-down { color: #ef4444; }

        /* --- PROJECT GRID --- */
        .filters { display: flex; gap: 1rem; margin-bottom: 1.5rem; background: var(--surface); padding: 1rem; border-radius: 12px; border: 1px solid var(--border); align-items: center; }
        .search-box { flex: 1; position: relative; }
        .search-box i { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-muted); }
        .search-box input { width: 100%; padding: 10px 10px 10px 40px; border: 1px solid var(--border); border-radius: 8px; outline: none; transition: 0.2s; }
        .search-box input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }

        .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem; }
        
        .project-card {
            background: var(--surface); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;
            transition: all 0.3s ease; cursor: pointer; position: relative; box-shadow: var(--shadow-sm);
        }
        .project-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-lg); border-color: #cbd5e1; }
        
        .card-header { padding: 1.25rem; border-bottom: 1px solid #f8fafc; display: flex; justify-content: space-between; align-items: flex-start; }
        .status-pill { padding: 4px 10px; border-radius: 20px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; }
        
        .st-Backlog { background: #f1f5f9; color: #475569; }
        .st-Desenvolvimento { background: #eff6ff; color: #1d4ed8; }
        .st-Homolog { background: #f3e8ff; color: #7e22ce; }
        .st-Entregue { background: #dcfce7; color: #15803d; }

        .card-body { padding: 1.25rem; }
        .card-title { font-weight: 700; font-size: 1.1rem; margin-bottom: 0.5rem; line-height: 1.4; }
        .card-desc { font-size: 0.9rem; color: var(--text-muted); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        
        .card-footer { padding: 1rem 1.25rem; background: #f8fafc; border-top: 1px solid var(--border); display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-muted); }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(4px); display: none; justify-content: center; align-items: center; z-index: 1000;
        }
        .modal-container {
            background: var(--surface); width: 90%; max-width: 1000px; height: 85vh; border-radius: 16px;
            display: flex; overflow: hidden; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); animation: slideUp 0.3s ease;
        }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .modal-main { flex: 2; padding: 2.5rem; overflow-y: auto; }
        .modal-sidebar { flex: 1; background: #f8fafc; border-left: 1px solid var(--border); padding: 2rem; display: flex; flex-direction: column; }

        .field-group { margin-bottom: 1.5rem; }
        .label { display: block; font-size: 0.75rem; font-weight: 700; color: #94a3b8; text-transform: uppercase; margin-bottom: 0.5rem; }
        .input-view { font-size: 1rem; color: var(--text-main); line-height: 1.6; }
        .technical-box { background: #1e293b; color: #e2e8f0; padding: 1rem; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9rem; }

        .timeline { margin-top: 2rem; border-top: 1px solid var(--border); padding-top: 1.5rem; }
        .timeline-item { display: flex; gap: 15px; margin-bottom: 1.5rem; }
        .timeline-dot { width: 12px; height: 12px; border-radius: 50%; background: var(--primary); margin-top: 6px; flex-shrink: 0; }
        .timeline-content h4 { font-size: 0.9rem; font-weight: 600; margin-bottom: 4px; }
        .timeline-content p { font-size: 0.85rem; color: var(--text-muted); }
        .timeline-date { font-size: 0.75rem; color: #94a3b8; }

        /* Responsive */
        @media (max-width: 1024px) {
            .metrics-grid { grid-template-columns: 1fr 1fr; }
        }
        @media (max-width: 768px) {
            body { flex-direction: column; overflow: auto; }
            aside { width: 100%; padding: 1rem; flex-direction: row; align-items: center; justify-content: space-between; }
            .nav-item span { display: none; }
            .modal-container { flex-direction: column; height: 100%; border-radius: 0; }
            .modal-sidebar { display: none; }
        }
    </style>
</head>
<body>

    <aside>
        <a href="#" class="brand">
            <i class="fa-solid fa-cube fa-lg"></i>
            <span>Nexus Gov</span>
        </a>
        <nav>
            <div class="nav-item active">
                <i class="fa-solid fa-chart-pie"></i> <span>Dashboard</span>
            </div>
            <div class="nav-item">
                <i class="fa-solid fa-list-check"></i> <span>Projetos (DRNs)</span>
            </div>
            <div class="nav-item">
                <i class="fa-solid fa-database"></i> <span>Data Lake</span>
            </div>
            <div class="nav-item">
                <i class="fa-solid fa-gear"></i> <span>Configurações</span>
            </div>
        </nav>
        <div style="margin-top: auto; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1)">
            <div style="display: flex; align-items: center; gap: 10px;">
                <img src="https://ui-avatars.com/api/?name=Diogo+Lima&background=random" style="width: 32px; height: 32px; border-radius: 50%;">
                <div style="font-size: 0.85rem;">
                    <div style="font-weight: 600;">Diogo Lima</div>
                    <div style="color: #94a3b8; font-size: 0.75rem;">Admin</div>
                </div>
            </div>
        </div>
    </aside>

    <main>
        <header>
            <div class="page-title">
                <h1>Painel de Controle</h1>
                <p>Visão geral de melhorias e demandas de Business Intelligence</p>
            </div>
            <button class="btn btn-primary" onclick="alert('Demo: Criar nova solicitação')">
                <i class="fa-solid fa-plus"></i> Nova Solicitação
            </button>
        </header>

        <div class="metrics-grid">
            <div class="metric-card">
                <div>
                    <div class="metric-label">Projetos Ativos</div>
                    <div class="metric-value">12</div>
                </div>
                <div class="metric-trend trend-up"><i class="fa-solid fa-arrow-trend-up"></i> +2 essa semana</div>
            </div>
            <div class="metric-card">
                <div>
                    <div class="metric-label">Taxa de Entrega</div>
                    <div class="metric-value">94%</div>
                </div>
                <div class="metric-trend trend-up"><i class="fa-solid fa-check"></i> Dentro do SLA</div>
            </div>
            <div class="metric-card">
                <div>
                    <div class="metric-label">Backlog (Fila)</div>
                    <div class="metric-value">8</div>
                </div>
                <div class="metric-trend trend-down"><i class="fa-solid fa-arrow-trend-down"></i> -3 vs mês anterior</div>
            </div>
            <div class="metric-card">
                <div style="height: 60px; width: 100%;">
                    <canvas id="miniChart"></canvas>
                </div>
            </div>
        </div>

        <div class="filters">
            <div class="search-box">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="text" id="searchInput" placeholder="Buscar por título, ID ou tag..." onkeyup="filterProjects()">
            </div>
            <select style="padding: 10px; border-radius: 8px; border: 1px solid var(--border); outline: none;">
                <option value="all">Todos os Status</option>
                <option value="Dev">Em Desenvolvimento</option>
                <option value="Entregue">Entregues</option>
            </select>
        </div>

        <div class="grid-container" id="projectGrid">
            </div>
    </main>

    <div class="modal-overlay" id="detailModal">
        <div class="modal-container">
            <div class="modal-main">
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 2rem;">
                    <div>
                        <span class="status-pill" id="m_status" style="margin-bottom: 10px; display: inline-block;"></span>
                        <h2 id="m_title" style="font-size: 2rem; color: var(--text-main);"></h2>
                        <span style="font-size: 0.9rem; color: var(--text-muted);" id="m_id"></span>
                    </div>
                    <button onclick="closeModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-muted);"><i class="fa-solid fa-xmark"></i></button>
                </div>

                <div class="field-group">
                    <span class="label">Descrição do Negócio</span>
                    <p class="input-view" id="m_desc"></p>
                </div>

                <div class="field-group">
                    <span class="label">Especificação Técnica (RPA/SQL)</span>
                    <div class="technical-box" id="m_tech"></div>
                </div>

                <div class="timeline">
                    <span class="label" style="margin-bottom: 1rem;">Histórico de Atualizações</span>
                    <div id="m_timeline_list"></div>
                </div>
            </div>
            <div class="modal-sidebar">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <i class="fa-solid fa-file-pdf fa-3x" style="color: #ef4444; margin-bottom: 1rem;"></i>
                    <p style="font-weight: 600; font-size: 0.9rem;" id="m_filename">Especificacao.pdf</p>
                    <button class="btn btn-primary" style="width: 100%; margin-top: 10px; justify-content: center;">
                        <i class="fa-solid fa-download"></i> Baixar Arquivo
                    </button>
                </div>
                
                <div class="field-group">
                    <span class="label">Solicitante</span>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="width: 30px; height: 30px; background: #e2e8f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; font-weight: 700;">MJ</div>
                        <span style="font-weight: 500;">Maria Juarez (Ops)</span>
                    </div>
                </div>

                <div class="field-group">
                    <span class="label">Previsão de Entrega</span>
                    <span style="font-weight: 600; color: var(--text-main);">15/02/2026</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. MOCK DATA (Fictício para Portfólio) ---
        // Dados gerados para parecerem reais e complexos
        const dbMock = [
            {
                id: "DRN-2026-001",
                title: "Automação de Validação de Endereços (RPA)",
                desc: "Implementação de robô para sanitização automática da base de endereços com índice de erro > 15%. O processo atual é manual e consome 40h/mês dos analistas.",
                tech: "Python (Selenium) + Pandas. Integração com API Google Maps para geocoding reverso. Saída em tabela Databricks 'tb_end_validado'.",
                status: "Em Homologação",
                client: "Logística Reversa",
                filename: "Espec_RPA_Enderecos_v2.pdf",
                timeline: [
                    { date: "08/01/2026 14:30", title: "Homologação Iniciada", msg: "Ambiente de UAT liberado para testes da área de negócio." },
                    { date: "05/01/2026 09:00", title: "Code Freeze", msg: "Desenvolvimento finalizado, realizando testes unitários." }
                ]
            },
            {
                id: "DRN-2026-002",
                title: "Painel de Controle de Entregas (Real-time)",
                desc: "Dashboard executivo para monitoramento de SLA das transportadoras parceiras em tempo real. Necessidade de visão por região e tipo de veículo.",
                tech: "Power BI com Direct Query no Databricks. View materializada 'vw_tracking_live' atualizada a cada 15min via Job.",
                status: "Entregue",
                client: "Diretoria Ops",
                filename: "Mockup_Dashboard_VFINAL.pptx",
                timeline: [
                    { date: "20/12/2025 10:00", title: "Projeto Entregue", msg: "Acesso liberado para a diretoria. Treinamento realizado." }
                ]
            },
            {
                id: "DRN-2026-003",
                title: "Extrator Financeiro - Conciliação de Fretes",
                desc: "Automação da extração de faturas para conciliação financeira. O sistema deve cruzar o valor previsto vs. realizado e apontar divergências acima de R$ 10,00.",
                tech: "SQL (Databricks) + Script Python para geração de Excel formatado e envio automático via SMTP.",
                status: "Em Desenvolvimento",
                client: "Financeiro",
                filename: "Requisitos_Conciliacao.docx",
                timeline: [
                    { date: "07/01/2026 11:15", title: "Desenvolvimento", msg: "Ajustando lógica de cálculo de impostos (ICMS) na query principal." }
                ]
            },
            {
                id: "DRN-2026-004",
                title: "API de Integração TMS x ERP",
                desc: "Desenvolvimento de endpoint para atualizar status de pedido no ERP legado assim que o TMS confirmar a baixa na entrega.",
                tech: "Node.js (Azure Functions). Webhook configurado no TMS disparando evento JSON.",
                status: "Backlog",
                client: "TI Sistemas",
                filename: "Arquitetura_API.pdf",
                timeline: [
                    { date: "02/01/2026 16:45", title: "Levantamento", msg: "Reunião de kickoff realizada com fornecedor do TMS." }
                ]
            },
            {
                id: "DRN-2026-005",
                title: "Análise Preditiva de Atrasos (Black Friday)",
                desc: "Modelo para prever gargalos na malha logística com base em dados históricos de 2023-2025.",
                tech: "Python (Scikit-Learn). Regressão Linear analisando volume vs. capacidade da frota.",
                status: "Em Homologação",
                client: "Planejamento",
                filename: "Estudo_Preditivo.pdf",
                timeline: [
                   { date: "09/01/2026 08:00", title: "Validação", msg: "Acuracidade do modelo atingiu 88%. Aguardando validação do gerente." } 
                ]
            }
        ];

        // --- 2. RENDER LOGIC ---
        
        function renderGrid(data) {
            const grid = document.getElementById('projectGrid');
            grid.innerHTML = '';

            data.forEach(item => {
                // Determine style based on status
                let stClass = 'st-Backlog';
                if(item.status.includes('Desenvolvimento')) stClass = 'st-Desenvolvimento';
                if(item.status.includes('Homologação')) stClass = 'st-Homolog';
                if(item.status.includes('Entregue')) stClass = 'st-Entregue';

                const card = document.createElement('div');
                card.className = 'project-card';
                card.onclick = () => openModal(item.id);
                card.innerHTML = `
                    <div class="card-header">
                        <span class="status-pill ${stClass}">${item.status}</span>
                        <i class="fa-solid fa-ellipsis" style="color: #cbd5e1;"></i>
                    </div>
                    <div class="card-body">
                        <div class="card-title">${item.title}</div>
                        <div class="card-desc">${item.desc}</div>
                    </div>
                    <div class="card-footer">
                        <span><i class="fa-regular fa-user"></i> ${item.client}</span>
                        <span><i class="fa-solid fa-code"></i> Auto/Data</span>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function filterProjects() {
            const term = document.getElementById('searchInput').value.toLowerCase();
            const filtered = dbMock.filter(i => 
                i.title.toLowerCase().includes(term) || 
                i.desc.toLowerCase().includes(term) ||
                i.status.toLowerCase().includes(term)
            );
            renderGrid(filtered);
        }

        // --- 3. MODAL LOGIC ---

        function openModal(id) {
            const item = dbMock.find(i => i.id === id);
            if(!item) return;

            document.getElementById('m_title').innerText = item.title;
            document.getElementById('m_id').innerText = item.id;
            document.getElementById('m_desc').innerText = item.desc;
            document.getElementById('m_tech').innerText = `Stack: ${item.tech}`;
            document.getElementById('m_status').innerText = item.status;
            document.getElementById('m_filename').innerText = item.filename;

            // Set status color in modal
            let stClass = 'st-Backlog';
            if(item.status.includes('Desenvolvimento')) stClass = 'st-Desenvolvimento';
            if(item.status.includes('Homologação')) stClass = 'st-Homolog';
            if(item.status.includes('Entregue')) stClass = 'st-Entregue';
            document.getElementById('m_status').className = `status-pill ${stClass}`;

            // Render Timeline
            const timelineContainer = document.getElementById('m_timeline_list');
            timelineContainer.innerHTML = '';
            item.timeline.forEach(t => {
                const row = document.createElement('div');
                row.className = 'timeline-item';
                row.innerHTML = `
                    <div class="timeline-dot"></div>
                    <div class="timeline-content">
                        <h4>${t.title}</h4>
                        <p>${t.msg}</p>
                        <span class="timeline-date">${t.date}</span>
                    </div>
                `;
                timelineContainer.appendChild(row);
            });

            document.getElementById('detailModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('detailModal').style.display = 'none';
        }

        // --- 4. INIT & CHARTS ---
        window.onload = () => {
            renderGrid(dbMock);

            // Mini Chart using Chart.js
            const ctx = document.getElementById('miniChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['S1', 'S2', 'S3', 'S4', 'S5'],
                    datasets: [{
                        data: [12, 19, 3, 5, 10],
                        backgroundColor: '#2563eb',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { display: false }, y: { display: false } }
                }
            });
        };
    </script>
</body>
</html>